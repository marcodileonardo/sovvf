<h3 class="d-inline-block mb-0">
    <i class="fa fa-question-circle"></i>
    Domande Triage
</h3>
<div class="mt-4">
    <ngb-accordion [closeOthers]="true">
        <ngb-panel id="tipologia-1">
            <ng-template ngbPanelTitle>
                1. Incendio generico
            </ng-template>
            <ng-template ngbPanelContent>
                <div class="">
                    <ng-select [(ngModel)]="dettaglioTipologiaTriage"
                               [items]="[{ codice: '1', descrizione: 'Indendio Tir' }]"
                               bindLabel="descrizione"
                               [placeholder]="'Seleziona un dettaglio tipologia di ' + 'Incendio generico'"
                               (ngModelChange)="onDettaglioTipologiaTriage($event)">
                    </ng-select>
                    <div class="text-left mt-2">
                        <button class="btn btn-lg btn-no-hover btn-primary mr-2"
                                [disabled]="!dettaglioTipologiaTriage"
                                (click)="onShowTriage()">
                            Continua
                        </button>
                    </div>
                </div>
                <ng-template [ngIf]="showTriage">
                    <div class="card card-shadow py-3 px-4 mt-3">
                        <h3 class="mt-2"><b>{{ dettaglioTipologiaTriage.descrizione }}</b>: Modifica Triage</h3>
                        <hr class="mt-3 mb-2">
                        <ng-template [ngIf]="tItems">
                            <ngx-treeview [items]="tItems"
                                          [config]="tConfig"
                                          [itemTemplate]="itemTemplate">
                            </ngx-treeview>
                            <div class="alert alert-danger font-weight-bolder mt-4">
                                Ci sono modifiche non ancora salvate, si prega di salvare per non perdere le modifiche.
                            </div>
                            <div class="text-left">
                                <button class="btn btn-lg btn-no-hover btn-primary mr-2">
                                    Salva Triage per "{{ dettaglioTipologiaTriage.descrizione }}"
                                </button>
                                <button class="btn btn-lg btn-no-hover btn-secondary">
                                    Reset
                                </button>
                            </div>
                        </ng-template>
                        <ng-template [ngIf]="!tItems">
                            <button class="btn btn-lg btn-no-hover btn-primary mr-2" (click)="initTriage()">
                                Inizializza Triage
                            </button>
                        </ng-template>
                    </div>
                </ng-template>
            </ng-template>
        </ngb-panel>
        <ngb-panel id="tipologia-2">
            <ng-template ngbPanelTitle>
                2. Incendio ed Esplosione
            </ng-template>
            <ng-template ngbPanelContent>
                <ngx-treeview [items]="tItems"
                              [config]="tConfig">
                </ngx-treeview>
            </ng-template>
        </ngb-panel>
        <ngb-panel id="tipologia-3">
            <ng-template ngbPanelTitle>
                3. Esplosione da sostanza esplodente
            </ng-template>
            <ng-template ngbPanelContent>
                <ngx-treeview [items]="tItems"
                              [config]="tConfig">
                </ngx-treeview>
            </ng-template>
        </ngb-panel>
    </ngb-accordion>
</div>


<ng-template #itemTemplate let-item="item" let-onCollapseExpand="onCollapseExpand">
    <div class="form-inline row-item font-xlarge item-treeview-custom mt-3">
        <i *ngIf="item.children" class="mr-2 text-info cursor-pointer" (click)="onCollapseExpand()" aria-hidden="true"
           [ngSwitch]="item.collapsed">
            <i *ngSwitchCase="true" class="fa fa-chevron-circle-down"></i>
            <i *ngSwitchCase="false" class="fa fa-chevron-circle-up"></i>
        </i>
        <div class="form-check">
            <label class="form-check-label cursor-pointer"
                   [class.text-info]="item.collapsed"
                   [class.text-dark]="!item.collapsed"
                   [class.font-weight-bolder]="!item.collapsed"
                   (click)="onCollapseExpand()">
                {{item.text}}
            </label>
            <label *ngIf="item.children?.length > 1" class="text-danger form-check-label cursor-pointer ml-2">
                <i class="fa fa-trash-o" ngbTooltip="Rimuovi" (click)="removeItem(item)"></i>
            </label>
            <label *ngIf="item.children?.length <= 0" class="text-primary form-check-label cursor-pointer ml-2">
                <i class="fa fa-plus-circle mr-2" ngbTooltip="Aggiungi" (click)="addDomanda(item)"></i>
                <!-- <i class="fa fa-thermometer" ngbTooltip="Aggiungi" (click)="addDomanda(item)"></i> -->
            </label>
            <ng-template [ngIf]="getItemData(item.value)?.soccorsoAereo">
                <label class="text-primary form-check-label cursor-pointer ml-2">
                    <i class="fa fa-plane mr-2"></i>
                    {{ getItemData(item.value)?.soccorsoAereo }}
                </label>
            </ng-template>
            <ng-template [ngIf]="getItemData(item.value)?.generiMezzo">
                <label class="text-primary form-check-label cursor-pointer ml-2">
                    <i class="fa fa-truck mr-2"></i>
                    <span *ngFor="let genereMezzo of getItemData(item.value)?.generiMezzo" class="d-inline-block mr-1">
                        {{ genereMezzo }}
                    </span>
                </label>
            </ng-template>
            <ng-template [ngIf]="getItemData(item.value)?.prioritaConsigliata">
                <label class="text-primary form-check-label cursor-pointer ml-2">
                    <i class="fa fa-thermometer mr-2"></i>
                    {{ getItemData(item.value)?.prioritaConsigliata }}
                </label>
            </ng-template>
        </div>
    </div>
</ng-template>
